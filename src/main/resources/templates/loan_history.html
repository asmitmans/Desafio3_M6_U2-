<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Loan History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<style>
		.no-spinner::-webkit-inner-spin-button,
		.no-spinner::-webkit-outer-spin-button {
			-webkit-appearance: none;
			margin: 0;
		}       
	</style>
</head>

<body class="bg-dark text-white">
	<div th:replace="~{navbar :: nav}"></div>
	<div class="container">
		<h1>Loan History</h1>
		
		<div th:if="${errorMessage}" class="alert alert-danger mt-2" role="alert">
			<span th:text="${errorMessage}"></span>
		</div>
		
		<form th:action="@{/loans/history}" method="get" class="mb-4">
			<div class="mb-3">
				<div class="input-group">
					<span class="input-group-text bg-dark text-white" id="basic-addon1">User Id:</span>
					<input type="number" id="userId" name="userId" class="form-control bg-dark text-white no-spinner" th:value="${userId}" required>
					<button type="submit" class="btn btn-outline-primary">Filter</button>
					<a href="/loans/history" class="btn btn-outline-secondary">Reset</a>
				</div>
			</div>
		</form>
		
        <div class="border border-light p-4 border-opacity-10">
            <table class="table table-dark table-striped table-bordered">
                <thead>
                    <tr class="thead-dark">
                        <th>ID</th>
                        <th>Title</th>
                        <th>Author</th>
						<th>User Id</th>
						<th>User Name</th>
                        <th>Loan Date</th>
                        <th>Return Date</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="loan : ${loans}">
                        <td th:text="${loan.getId()}"></td>
                        <td th:text="${loan.getBook().getTitle()}"></td>
                        <td th:text="${loan.getBook().getAuthor()}"></td>
						<td th:text="${loan.getUser().getId()}"></td>
						<td th:text="${loan.getUser().getFullName()}"></td>
                        <td th:text="${loan.getLoanDate()}"></td>
                        <td th:text="${loan.getReturnDate() != null} ? ${loan.getReturnDate()} : 'Not Returned'"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
	
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous">
	</script>
</body>
</html>